/*!
 * tsorter 2.0.1 - Copyright 2015 Terrill Dent, http://terrill.ca
 * JavaScript HTML Table Sorter
 * Released under MIT license, http://terrill.ca/sorting/tsorter/LICENSE
 */
var tsorter=function(){"use strict";var e,t,n,r,s,c,o=!!document.addEventListener,a=document.createElement("style");return document.head.appendChild(a),a.sheet.insertRule(".tsorterSortable th { cursor: pointer }",0),a.sheet.insertRule('.tsorterSortable th.descend:after { content: " ▲" }',0),a.sheet.insertRule('.tsorterSortable th.ascend:after { content: " ▼" }',0),Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),t=function(e,t,n){o?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},n=function(e,t,n){o?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},r=function(e,t){var n;t=(e=c(e,t))?e.innerHTML:"";if(e&&(n=s(t)))return n},s=function(e){return/^[\+\-]?(?:\d*\.)?\d+$/.test(e)?"numeric":null},c=function(e,t){for(var n=e;n.children&&0<n.children.length;)n=n.children[t];return n},e={getCell:function(e){return this.trs[e].cells[this.column]},sort:function(e){var t,n=this,s=e.target,c=s.parentNode.tagName,o=s.getAttribute("data-tsorter")||r(n.trs[1],s.cellIndex);e=!!document.body.classList;"th"!==c.toLowerCase()&&(n.column=n.getHeaderIndex(n.table,s),n.get=n.getAccessor(o),console.log("Sorting by column number "+n.column),e?((t=s.classList).contains("descend")?(t.add("ascend"),t.remove("descend"),n.sortAscending=!0):(t.contains("ascend")&&t.remove("ascend"),t.add("descend"),n.sortAscending=!1),-1!==n.prevCol&&n.prevCol!==n.column&&(n.ths[n.prevCol].classList.remove("ascend"),n.ths[n.prevCol].classList.remove("descend"))):(-1<(t=s.className.split(" ")).indexOf("descend")?(s.className=s.className.replace("descend","ascend"),n.sortAscending=!0):(-1<t.indexOf("ascend")?s.className=s.className.replace("ascend","descend"):s.className+=" descend",n.sortAscending=!1),-1!==n.prevCol&&n.prevCol!==n.column&&(n.ths[n.prevCol].className.replace("ascend",""),n.ths[n.prevCol].className.replace("descend",""))),n.quicksort(0,n.trs.length),n.prevCol=n.column)},getAccessor:function(e){var t=this,n=t.accessors;if(n&&n[e])return n[e];switch(e){case"link":return function(e){return t.getCell(e).firstChild.firstChild.nodeValue};case"input":return function(e){return t.getCell(e).firstChild.value};case"numeric":return function(e){return parseFloat(t.getCell(e).firstChild.nodeValue.replace(",",".").replace(/[^0-9\-.]+/g,""),10)};case"date-time":return function(e){return t.getCell(e).firstChild.nodeValue.toLowerCase().replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$3-$2-$1")};default:return function(e){return void 0!==t.getCell(e)&&null!=t.getCell(e).firstChild?t.getCell(e).firstChild.nodeValue:""}}},exchange:function(e,t){var n=this.tbody,r=this.trs;e===t+1?n.insertBefore(r[e],r[t]):t===e+1?n.insertBefore(r[t],r[e]):(t=n.replaceChild(r[e],r[t]),r[e]?n.insertBefore(t,r[e]):n.appendChild(t))},quicksort:function(e,t){var n,r,s,c=this;if(!(t<=e+1)){for(n=e+1,r=t-1,c.get(e)>c.get(n)&&c.exchange(n,e),c.get(r)>c.get(e)&&c.exchange(e,r),c.get(e)>c.get(n)&&c.exchange(n,e),s=c.get(e);;){if(c.sortAscending){for(;s>c.get(r);)r--;for(;c.get(n)>s;)n++}else{for(;s<c.get(r);)r--;for(;c.get(n)<s;)n++}if(r<=n)break;(c.get(n)>c.get(r)||c.get(n)<c.get(r))&&c.exchange(n,r),n++,r--}(c.get(e)>c.get(r)||c.get(e)<c.get(r))&&c.exchange(e,r),r-e<t-r?(c.quicksort(e,r),c.quicksort(r+1,t)):(c.quicksort(r+1,t),c.quicksort(e,r))}},getHeaderIndex:function(e,t){for(var n=e.tHead.getElementsByTagName("th"),r=0,s=0;s<n.length;s++){var c=n[s];if(c.innerHTML===t.innerHTML)return r;r+=c.colSpan}},readHeaders:function(e){for(var t=e.tHead.getElementsByTagName("th"),n=[],r=0,s=0;s<t.length;s++)for(var c=t[s],o=0;o<c.colSpan;o++)n[r]=c,r++,console.log("Adding a header at index "+r+" for header "+c.innerHTML);return n},init:function(e,n,s){var c,o=this;if("string"==typeof e&&(e=document.getElementById(e)),e&&null!=e){for(e.className.indexOf("tsorterSortable")<=-1&&(e.className+=" tsorterSortable"),o.table=e,o.ths=o.readHeaders(e),o.tbody=e.tBodies[0],o.trs=o.tbody.getElementsByTagName("tr"),o.prevCol=n&&0<n?n:-1,o.accessors=s,o.boundSort=o.sort.bind(o),c=0;c<o.ths.length;c++)t(o.ths[c],"click",o.boundSort);void 0!==n&&o.ths.length>=n&&(o.ths[n].className+=" ascend",n=(s=o.ths[n]).getAttribute("data-tsorter")||r(o.trs[1],s.cellIndex),o.column=s.cellIndex,o.get=o.getAccessor(n),o.quicksort(1,o.ths.length),o.prevCol=o.column)}},destroy:function(){var e;if(this.ths)for(e=0;e<this.ths.length;e++)n(this.ths[e],"click",this.boundSort)}},{create:function(t,n,r){var s=Object.create(e);return s.init(t,n,r),s}}}();
